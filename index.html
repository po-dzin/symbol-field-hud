<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SymbolField HUD</title>
<style>
:root{--bg:#fafafa;--fg:#111;--border:#e6e6e6;--muted:#666;}
body[data-theme="dark"]{--bg:#0f0f0f;--fg:#fafafa;--border:#222;}
body[data-theme="zen"]{--bg:#f9f7f2;--fg:#222;}
body[data-theme="light"]{--bg:#ffffff;--fg:#111;}
body{
 background:var(--bg);color:var(--fg);
 font:15px/1.5 Inter,system-ui,sans-serif;margin:0;
 transition:background .6s ease,color .3s ease;
}
/* mood-based gradients */
body[data-mood="🔴"]{background:radial-gradient(circle at 50% 20%,#ffb3b3,#1a0000);}
body[data-mood="🟠"]{background:radial-gradient(circle at 50% 20%,#ffd8b3,#331500);}
body[data-mood="🟢"]{background:radial-gradient(circle at 50% 20%,#c6ffcc,#00280d);}
body[data-mood="🔵"]{background:radial-gradient(circle at 50% 20%,#b3e1ff,#001433);}
body[data-mood="🟣"]{background:radial-gradient(circle at 50% 20%,#e5b3ff,#2b0044);}
h1{text-align:center;margin:20px 0;font-size:2rem;font-weight:600;letter-spacing:.03em;
 background:linear-gradient(90deg,#111,#555);
 -webkit-background-clip:text;-webkit-text-fill-color:transparent;}
body[data-mode="🔆"] h1{background:linear-gradient(90deg,#ff9800,#ffc400);}
body[data-mode="♾️"] h1{background:linear-gradient(90deg,#38bdf8,#a855f7);}
body[data-mode="🕳️"] h1{background:linear-gradient(90deg,#111,#333);}
.grid{max-width:1100px;margin:auto;display:grid;gap:18px;padding:0 16px}
@media(min-width:900px){.grid{grid-template-columns:280px 1fr 280px}}
.card{background:#fff;border:1px solid var(--border);border-radius:14px;overflow:hidden}
.hd{padding:12px 14px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.bd{padding:12px 14px}
.row{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
.badge{border:1px solid var(--border);border-radius:999px;padding:3px 8px;font-size:12px}
.btn{border:1px solid var(--border);border-radius:999px;padding:5px 10px;background:none;cursor:pointer}
.btn[aria-current="true"]{background:var(--fg);color:var(--bg)}
.mono{font-family:ui-monospace,monospace}
.progress{height:6px;background:#e6e6e6;border-radius:999px;overflow:hidden}
.bar{height:100%;background:var(--fg)}
.hint{font-size:12px;color:var(--muted)}
.list{max-height:220px;overflow:auto;border:1px solid var(--border);border-radius:10px}
.item{padding:6px 10px;border-bottom:1px solid var(--border)}
</style>
</head>
<body data-mode="♾️" data-theme="status" data-mood="🟢">
<h1>SymbolField HUD</h1>
<div class="grid">
  <!-- LEFT: STATE -->
  <div>
    <div class="card">
      <div class="hd"><div id="t_state"></div>
        <div><select id="lang">
          <option value="ru">RU</option><option value="en">EN</option></select></div></div>
      <div class="bd">
        <div id="dateMoon"></div>

        <div class="row mt8">
          <span class="badge">Mode</span>
          <button class="btn" id="m1">🕳️</button>
          <button class="btn" id="m2">♾️</button>
          <button class="btn" id="m3">🔆</button>
        </div>
        <div class="hint" id="mode_hint"></div>

        <div class="row mt8">
          <span class="badge">Mood</span>
          <button class="btn" id="mo1">🔴</button>
          <button class="btn" id="mo2">🟠</button>
          <button class="btn" id="mo3">🟢</button>
          <button class="btn" id="mo4">🔵</button>
          <button class="btn" id="mo5">🟣</button>
        </div>
        <div class="hint" id="mood_hint"></div>

        <div class="row mt8">
          <span class="badge">Glyph</span>
          <button class="btn" id="g1">•</button><button class="btn" id="g2">∣</button>
          <button class="btn" id="g3">◯</button><button class="btn" id="g4">⊙</button>
          <button class="btn" id="g5">∿</button>
        </div>
      </div>
    </div>

    <div class="card mt16"><div class="hd"><div id="t_xp"></div></div>
      <div class="bd" id="xp"></div>
    </div>
  </div>

  <!-- CENTER -->
  <div>
    <div class="card"><div class="hd"><div>/arc + /quest</div></div>
      <div class="bd" id="arcquest">Arc A1 — Awakening · Quest: Stabilize ritual loop</div></div>
    <div class="card mt16"><div class="hd"><div>/quote</div></div>
      <div class="bd" id="quote">«Кольцо дышит. Зерно светится. Тишина держит форму.»</div></div>
    <div class="card mt16"><div class="hd"><div>/reminder</div></div>
      <div class="bd">∣ ◯ ⊙ → Vipassana + breath + charge (08:00)</div></div>
  </div>

  <!-- RIGHT -->
  <div>
    <div class="card"><div class="hd"><div>/xp + /audit</div></div>
      <div class="bd list" id="log"></div></div>
    <div class="card mt16"><div class="hd"><div>Theme</div></div>
      <div class="bd">
        <select id="theme">
          <option value="status">Status-depended</option>
          <option value="dark">Dark</option>
          <option value="zen">Zen</option>
          <option value="light">Light</option>
        </select>
      </div></div>
  </div>
</div>

<script>
const T={ru:{state:"Состояние",xp:"Панель опыта"},
          en:{state:"State",xp:"XP Dashboard"}};
let lang=localStorage.getItem("lang")||"ru";
let mode="♾️",glyph="◯",mood="🟢",theme="status";
const xp={HP:15,CP:3,MP:3,DP:29};
const modeHints={"🕳️":"shadow · depth · compression",
                 "♾️":"flow · synthesis · resonance",
                 "🔆":"radiance · broadcast · clarity"};
const moodHints={
  "🔴":"vital · active · embodied",
  "🟠":"creative · expressive · warm",
  "🟢":"balanced · centered · organic",
  "🔵":"clear · focused · calm",
  "🟣":"integral · inspired · subtle"
};

function render(){
 document.body.dataset.mode=mode;
 document.body.dataset.theme=theme==="status"?mode:theme;
 document.body.dataset.mood=mood;
 document.getElementById("t_state").textContent=T[lang].state;
 document.getElementById("t_xp").textContent=T[lang].xp;
 document.getElementById("mode_hint").textContent=modeHints[mode];
 document.getElementById("mood_hint").textContent=moodHints[mood];
 const xpDom=Object.entries(xp).map(([k,v])=>{
   const pct=Math.min(100,v%100);
   return `<div class='mt8'><div class='row'><strong>${k}</strong><span>${["🪨","💧","🔥","🌬️"]["HP CP MP DP".split(" ").indexOf(k)]}</span><span class='mono'>${v}</span></div><div class='progress'><div class='bar' style='width:${pct}%'></div></div></div>`;
 }).join("");
 document.getElementById("xp").innerHTML=xpDom;
}
document.querySelectorAll("#m1,#m2,#m3").forEach((b,i)=>{
 b.onclick=()=>{mode=["🕳️","♾️","🔆"][i];log(`∷ Mode → ${mode}`);render();};
});
document.querySelectorAll("#g1,#g2,#g3,#g4,#g5").forEach((b,i)=>{
 b.onclick=()=>{glyph=["•","∣","◯","⊙","∿"][i];log(`◐ Glyph → ${glyph}`);};
});
document.querySelectorAll("#mo1,#mo2,#mo3,#mo4,#mo5").forEach((b,i)=>{
 b.onclick=()=>{mood=["🔴","🟠","🟢","🔵","🟣"][i];log(`♦ Mood → ${mood}`);render();};
});
document.getElementById("theme").onchange=e=>{theme=e.target.value;render();};
document.getElementById("lang").onchange=e=>{lang=e.target.value;localStorage.setItem("lang",lang);render();};
function log(t){const L=document.getElementById("log");const e=document.createElement("div");
 e.className="item mono";e.textContent=`[${new Date().toLocaleTimeString()}] ${t}`;L.prepend(e);}

// 🌕 Moon phase + quarters
async function updateMoon(){
 const now=Math.floor(Date.now()/1000);
 try{
   const res=await fetch(`https://api.farmsense.net/v1/moonphases/?d=${now}`);
   const data=await res.json();
   const phase=data?.[0]?.Phase||"unknown";
   const age=data?.[0]?.Age||0;
   // map phase → icon + quarter
   let icon="🌘",quarter=4;
   if(phase.includes("New")){icon="🌑";quarter=1;}
   else if(phase.includes("Waxing Crescent")){icon="🌒";quarter=1;}
   else if(phase.includes("First Quarter")){icon="🌓";quarter=2;}
   else if(phase.includes("Waxing Gibbous")){icon="🌔";quarter=2;}
   else if(phase.includes("Full")){icon="🌕";quarter=3;}
   else if(phase.includes("Waning Gibbous")){icon="🌖";quarter=3;}
   else if(phase.includes("Last Quarter")){icon="🌗";quarter=4;}
   else if(phase.includes("Waning Crescent")){icon="🌘";quarter=4;}
   const dateStr=new Date().toLocaleDateString(lang==="ru"?"ru-RU":"en-GB",
     {day:"numeric",month:"long",year:"numeric"});
   document.getElementById("dateMoon").textContent=
     `${dateStr} · ${icon} ${phase} · Q${quarter}`;
 }catch{document.getElementById("dateMoon").textContent="Moon API unavailable";}
}
render();updateMoon();
</script>
</body>
</html>
